(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{347:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"分支管理策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分支管理策略"}},[s._v("#")]),s._v(" 分支管理策略")]),s._v(" "),a("h2",{attrs:{id:"禁用-fast-forward-的合并"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁用-fast-forward-的合并"}},[s._v("#")]),s._v(" 禁用 Fast forward 的合并")]),s._v(" "),a("p",[s._v("通常，合并分支时，如果可能，Git会用 Fast forward 模式，但这种模式下，删除分支后，会丢掉分支信息。")]),s._v(" "),a("p",[s._v("如果要强制禁用 Fast forward 模式，Git 就会在 merge 时生成一个新的 commit，这样，从分支历史上就可以看出分支信息。")]),s._v(" "),a("p",[s._v("下面我们实战一下 "),a("code",[s._v("--no-ff")]),s._v(" 方式的 git merge：")]),s._v(" "),a("p",[s._v("首先，仍然创建并切换 dev 分支：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" switch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" dev\nSwitched to a new branch "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dev'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("修改 "),a("code",[s._v("readme.txt")]),s._v(" 文件，并提交一个新的 commit：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" readme.txt\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"AND simple"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("feature1 a2a17d3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" AND simple\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" insertion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" deletion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" readme.txt \n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"add merge"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dev d234112"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" merge\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" insertion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("现在，我们切换回 "),a("code",[s._v("master")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" switch master\nSwitched to branch "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'master'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("准备合并 "),a("code",[s._v("dev")]),s._v(" 分支，请注意 "),a("code",[s._v("--no-ff")]),s._v(" 参数，表示禁用 Fast forward：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --no-ff "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"merge with no-ff"')]),s._v(" dev\nMerge made by the "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'recursive'")]),s._v(" strategy.\n readme.txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" +\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" insertion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("因为本次合并要创建一个新的 commit，所以加上 "),a("code",[s._v("-m")]),s._v(" 参数，把 commit 描述写进去。\n合并后，我们用 "),a("code",[s._v("git log")]),s._v(" 看看分支历史：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--graph")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--pretty")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("oneline --abbrev-commit\n*   6200b3e "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HEAD -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" merge with no-ff\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" * d234112 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" merge\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("/  \n*   1a4cbfd conflict fixed\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("可以看到，不使用 Fast forward 模式，merge 后就像这样：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://nagiko.oss-cn-shanghai.aliyuncs.com/kana/git-guide/43.1.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"分支管理策略-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分支管理策略-2"}},[s._v("#")]),s._v(" 分支管理策略")]),s._v(" "),a("p",[s._v("在实际开发中，我们应该按照几个基本原则进行分支管理：")]),s._v(" "),a("p",[s._v("首先，"),a("code",[s._v("master")]),s._v(" 分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面干活；")]),s._v(" "),a("p",[s._v("那在哪干活呢？干活都在 "),a("code",[s._v("dev")]),s._v(" 分支上，也就是说，"),a("code",[s._v("dev")]),s._v(" 分支是不稳定的，到某个时候，比如 1.0 版本发布时，再把 "),a("code",[s._v("dev")]),s._v(" 分支合并到 "),a("code",[s._v("master")]),s._v(" 上，在 master 分支发布 1.0 版本；")]),s._v(" "),a("p",[s._v("你和你的小伙伴们每个人都在 "),a("code",[s._v("dev")]),s._v(" 分支上干活，每个人都有自己的分支，时不时地往 "),a("code",[s._v("dev")]),s._v(" 分支上合并就可以了。")]),s._v(" "),a("p",[s._v("所以，团队合作的分支看起来就像这样：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://nagiko.oss-cn-shanghai.aliyuncs.com/kana/git-guide/43.2.png",alt:""}})])])}),[],!1,null,null,null);a.default=n.exports}}]);