# 忽略配置文件

## 忽略配置文件是什么？有什么用？

有些文件虽然在 Git 工作区中，但你不希望提交他们，比如一些缓存文件、一些密码配置文件等。这些文件你永远不会也不能提交它们。你会怎么处理这些文件？
你可能会说，前面有提到过暂存区的概念。只有先 `git add` 把文件添加到暂存区，然后再 `git commit` 把暂存区的文件提交到 Git，那么这些文件我永远也不 `git add` 就可以了。这确实是一个办法，但是当这些不提交的文件越来越多，你每次 `git status` 时都会发现有大量文件处于 `Untracked files....` 的状态，你的工作区永远也不会干净。
如果有一个特殊的配置文件，将这些你不需要提交的文件写进这个特殊文件里，Git 如果能在你 `git add` 的时候自动忽略这些文件，不把它们当做 Git 工作区的一部分，是不是就方便许多？
而事实上 Git 提供了这样的配置文件，就是 Git 的忽略配置文件。
## 创建忽略配置文件

忽略配置文件名称是 `.gitignore`。注意它名称以 `.` 开头，所以它会被大多数操作系统视为隐藏的文件，所以在创建完这个文件后你就会发现它“消失”了。这个时候将你的文件管理器设置为“显示隐藏的文件”，你就会再看见他了。`.gitignore` 这个名字是固定的，你不能改变。
你可以用 `Visual Studio Code` **在 Git 工作区的根目录下**创建这个文件。最好不要用“记事本”创建，因为前面提到过，记事本会在文件开头自动给你添加一些特殊字符，会有不可预估的影响。
打开 `.gitignore` 文件，接下来我们往里面添加内容。
## 添加忽略文件

往忽略配置文件里添加内容没有什么特殊规则，只要将你不需要提交的文件名写进去就可以了，一行一个：
```
myPasswd.txt
myCacheFiles
```
当然你也可以往里面添加文件夹，git 会忽略文件夹下的所有文件，包括其子目录：
```
allCacheFilesFold/
```
可以像这样在名称尾添加 `/` 来代表这是一个文件夹。
你也可以忽略某个文件夹下的某个文件或者其子目录：
```
allCacheFilesFolder/
allCacheFilesFolder/myFile.txt
allCacheFilesFolder/subFolder/
```
## 避开忽略规则强制添加文件

有些时候，你想添加一个文件到 Git，但发现添加不了，原因可能是这个文件被 `.gitignore` 忽略了，要确定 `.gitignore` 中是否有关于该文件的规则，你可以这样：
```shell
$ git check-ignore -v App.class
.gitignore:3:*.class	App.class
```
该命令的输出会告诉你 `.gitignore` 文件的哪一行、什么规则使该文件被忽略了，我们就可以修改忽略规则了。
当然你也可以在 `git add` 的时候添加 `-f` 参数来强制改文件提交：
```shell
$ git add -f App.class
```
但是不建议这样做，因为这样做与 `.gitignore` 文件规则冲突，破坏其规则。
## 忽略配置文件的例外规则

其实有另外一种更好的方式处理上面的问题：你可以在 `.gitignore` 中添加“例外规则”来使该文件可以被添加到 Git：
```
allCacheFilesFolder/
allCacheFilesFolder/myFile.txt
allCacheFilesFolder/subFolder/

!App.class
```
这样 `.gitignore` 在忽略规则使，就会把 `App.class` 排除，让它可以被正常添加到 Git。
## 忽略规则文件也应该被 Git 管理

`.gitignore` 文件本身也应该被 Git 管理，什么意思？简单说来就是 `.gitignore` 文件也应该 `git add` 添加到 Git 做版本管理，这样有什么好处呢？
多人协作同一个项目时，你本地有需要缓存文件或者密码文件不需要提交，其他团队成员大概率也有。如果将 `.gitignore` 传到 Git 中去，他们项目文件夹下也会有这份文件，团队成员之间可以保存相同的忽略规则。
## 忽略配置文件不处理已经提交到 Git 的文件

如果你的文件已经提交到 Git 中去了，然后你再在 `.gitigore` 中忽略该文件，此时是无效的。解决方法就是：你可以先将该文件拷贝出来，然后在 Git 工作区中删除这个文件（如果已经提交到远程仓库了，确保远程仓库该文件也被删除了，方法就是删除文件后进行 `push` 操作即可）。最后将这个文件重新添加到 Git。
